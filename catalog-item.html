<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HELI – Catalog Details</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">

  <link rel="stylesheet" href="catalog-item.css">
  <link rel="stylesheet" href="index.css">
</head>

<body class="page-fade">

<!-- NAVBAR / MODAL / FOOTER placeholders -->
<div id="navbar-placeholder"></div>
<div id="modal-placeholder"></div>

<!-- HEADER -->
<section id="categoryHeader" class="category-header">
  <div class="category-header-overlay"></div>

  <div class="category-header-content container text-center">
    <h1 id="categoryName"></h1>
    <p id="categoryDesc" class="mt-3"></p>
  </div>
</section>


<!-- PRODUCT GRID -->
<section class="container py-5">
  <h3 class="mb-4" id="availableTitle" data-i18n="available_models">Available Models</h3>
  <div id="productGrid" class="row g-4"></div>
</section>

<!-- FOOTER -->
<div id="footer-placeholder"></div>

<!-- Scripts -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="index.js"></script>
<script src="catalog-item.js"></script>

<!-- SINGLE FINAL LOADER — DO NOT DUPLICATE -->
<script>
document.addEventListener("DOMContentLoaded", async () => {
  try {
    console.log("[loader] start");

    /* 1️⃣ Load NAVBAR */
    const navRes = await fetch("navbar.html");
    if (!navRes.ok) throw new Error("navbar.html fetch failed");
    document.getElementById("navbar-placeholder").innerHTML = await navRes.text();

    if (typeof initSharedUI === "function") initSharedUI();
    if (typeof initLanguageSwitcher === "function") initLanguageSwitcher();

    /* 2️⃣ Load LANGUAGE BEFORE ANY PAGE LOGIC */
    window.currentLang = localStorage.getItem("heli-lang") || "uz";
    if (typeof loadLanguage === "function") {
      await loadLanguage(window.currentLang);
    }
    if (typeof setActiveLangButton === "function") setActiveLangButton();

    /* 3️⃣ Load MODAL */
    const modalRes = await fetch("modal.html");
    if (modalRes.ok) {
      document.getElementById("modal-placeholder").innerHTML = await modalRes.text();
      if (typeof initSharedUI === "function") initSharedUI();
    }

    /* 4️⃣ Load FOOTER */
    const footRes = await fetch("footer.html");
    if (footRes.ok) {
      document.getElementById("footer-placeholder").innerHTML = await footRes.text();
    }

    /* 5️⃣ Finally load the category + product cards */
    if (typeof loadCatalogPage === "function") {
      await loadCatalogPage();
    } else {
      console.error("loadCatalogPage() missing");
      document.getElementById("productGrid").innerHTML =
        "<div class='col-12 text-danger'>Page script missing</div>";
    }

  } catch (err) {
    console.error("Loader error:", err);
    document.getElementById("productGrid").innerHTML =
      `<div class="col-12 text-danger">Error loading page: ${err.message}</div>`;
  }
});
</script>

</body>
</html>
